3700. Number of ZigZag Arrays II

You are given three integers `n`, `l`, and `r`.

A **ZigZag** array of length `n` is defined as follows:

* Each element lies in the range `[l, r]`.
* No **two adjacent** elements are equal.
* No **three** consecutive elements form a **strictly increasing** or **strictly decreasing** sequence.

Return the total number of valid **ZigZag** arrays.

Since the answer may be large, return it modulo `10^9 + 7`.

A **sequence** is said to be **strictly increasing** if each element is strictly greater than its previous one (if exists).

A **sequence** is said to be **strictly decreasing** if each element is strictly smaller than its previous one (if exists).

 

**Example 1:**
```
Input: n = 3, l = 4, r = 5

Output: 2

Explanation:

There are only 2 valid ZigZag arrays of length n = 3 using values in the range [4, 5]:

[4, 5, 4]
[5, 4, 5]
```

**Example 2:**
```
Input: n = 3, l = 1, r = 3

Output: 10

Explanation:

There are 10 valid ZigZag arrays of length n = 3 using values in the range [1, 3]:

[1, 2, 1], [1, 3, 1], [1, 3, 2]
[2, 1, 2], [2, 1, 3], [2, 3, 1], [2, 3, 2]
[3, 1, 2], [3, 1, 3], [3, 2, 3]
All arrays meet the ZigZag conditions.
```
 

**Constraints:**

* `3 <= n <= 109`
* `1 <= l < r <= 75`

# Submissions
---
**Solution 1: (Fast Pow)**
```
Runtime: 820 ms, Beats 100.00%
Memory: 30.08 MB, Beats 9.03%
```
```python
import numpy as np

class Solution:
    def zigZagArrays(self, n: int, l: int, r: int) -> int:
        MOD = 1_000_000_007
        k = r - l + 1
        m = np.array([[int(i + j + 1 < k) for j in range(k)] for i in range(k)], dtype=object)
        res = np.ones((1, k), dtype=object)
        n -= 1
        while n:
            if n & 1:
                res = (res @ m) % MOD
            m = (m @ m) % MOD
            n >>= 1
        return int(res.sum() * 2 % MOD)
```
